## 主从数据库是什么

```
一个主数据库，多个从数据库，
主库对外提供读写的操作，从库对外提供读操作
```

作用

```
- 高可用，实时灾备，用于故障切换。比如主库挂了，可以切从库。
- 读写分离，提供查询服务，减少主库压力，提升性能
- 备份数据，避免影响业务。
```

## 数据库主从复制原理

<img src="https://cdn.jsdelivr.net/gh/iamk123/typora@main/uPic/2023/08/19/10523216924135521692413552454OwckKr-640-20230819105232325.png" alt="图片" style="zoom:50%;" />

```
（1）主数据库有个bin log二进制文件，纪录了所有增删改SQL语句。
（2）从库发起连接，连接到主库。
（3）此时主库创建一个binlog dump线程，把bin log的内容发送到从库。
（4）从库启动之后，创建一个I/O线程，读取主库传过来的bin log内容并写入到中继日志relay log
（5）从库还会创建一个SQL线程，从relay log里面读取内容，从ExecMasterLog_Pos位置开始执行读取到的更新事件，将更新内容写入到slave的db
```

## 主主、主从、主备的区别

主主

```
两台都是主数据库，同时对外提供读写操作。客户端访问任意一台。数据存在双向同步。
```

主从

```
一台是主数据库，同时对外提供读写操作。一台是从数据库，对外提供读的操作。数据从主库同步到从库。
```

主备

```
一台是主数据库，同时对外提供读写操作。
一台是备库，只作为备份作用，不对外提供读写，主机挂了它就取而代之。数据从主库同步到备库。
```



## MySQL是怎么保证主从一致的 TODO

```

```

参考

-   [面试必备：聊聊MySQL的主从](https://mp.weixin.qq.com/s?__biz=Mzg3NzU5NTIwNg==&mid=2247497982&idx=1&sn=bb589329cceb5462fc41f66ec63dbf56&chksm=cf2227d7f855aec16dd4d3b3425c0401850eeaf2c9cdc82e82722d38a00c24ee9ccfa3353774&token=2044040586&lang=zh_CN#rd)